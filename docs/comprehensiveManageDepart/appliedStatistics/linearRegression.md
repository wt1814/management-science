

<!-- TOC -->

- [1. 线性回归分析](#1-线性回归分析)
    - [1.1. 回归分析概述](#11-回归分析概述)
    - [1.2. 线性回归流程](#12-线性回归流程)
    - [1.3. 一元线性回归分析](#13-一元线性回归分析)
        - [1.3.1. `建立模型`](#131-建立模型)
            - [1.3.1.1. 回归模型的建立](#1311-回归模型的建立)
            - [1.3.1.2. 回归模型的基本特征](#1312-回归模型的基本特征)
        - [1.3.2. `参数估计，β0和β1的估计`，最小二乘估计](#132-参数估计β0和β1的估计最小二乘估计)
            - [1.3.2.1. 最小二乘估计的基本思想](#1321-最小二乘估计的基本思想)
            - [1.3.2.2. ★★★步骤](#1322-★★★步骤)
        - [1.3.3. ★★★`参数估计，a²的估计`，可决系数r^2与相关系数r](#133-★★★参数估计a²的估计可决系数r^2与相关系数r)
            - [1.3.3.1. 计算](#1331-计算)
            - [1.3.3.2. 说明](#1332-说明)
        - [1.3.4. ~~校验（不看）~~](#134-校验不看)
            - [1.3.4.1. 回归效果的【显著性检验】与方差分析表](#1341-回归效果的显著性检验与方差分析表)
                - [1.3.4.1.1. F校验](#13411-f校验)
                - [1.3.4.1.2. t校验](#13412-t校验)
            - [1.3.4.2. 回归参数的【假设检验】与区间估计](#1342-回归参数的假设检验与区间估计)
        - [1.3.5. ~~应用：预测（不看）~~](#135-应用预测不看)
    - [1.4. 多元线性回归分析](#14-多元线性回归分析)
    - [1.5. 线性模型的适宜性评价](#15-线性模型的适宜性评价)

<!-- /TOC -->


# 1. 线性回归分析  
<!-- 
https://www.cnblogs.com/datamining-bio/p/9502033.html
https://zhuanlan.zhihu.com/p/429506268?utm_id=0

*** 参考大纲  
-->

<!-- 

大纲  
1. 考试范围   
&emsp; 散点图，简单线性回归模型及其基本理论假设，简单线性回归模型的基本特征，回归参数的估计，相关系数与可决系数，方差分析表与回归效果显著性检验，回归系数的置信区间与假设检验，估计和预测。  
&emsp; 多元线性回归模型及其基本理论假设，回归参数的最小二乘估计，参数估计量的统计特性，复可决系数方差分析表与回归效果显著性检验(全检验)，回归系数的假设检验(偏检验)，回归系数的置信区间，应用拟合模型进行估计和预测。  
2. 考试要求  
&emsp; 应用散点图判断变量之间相关关系的类型，掌握线性回归模型及其基本理论假设，识记线性回归模型的基本特征，应用最小二乘估计法估计回归参数，识记相关系数与(复)可决系数的含义，掌握方差分析表中各变量之间的关系，应用方差分析表进行回归效果显著性检验，掌握对回归参数进行参数估计和假设检验的方法，能够应用拟合模型进行估计和预测。  
&emsp; 掌握线性回归模型适宜性评价的内容：非线性、异方差性、序列相关性、非正态性和多重共线性，应用残差散点图判断。  
-->

## 1.1. 回归分析概述
1. 基本概念：  
&emsp; 回归分析是研究一个因变量与一个或几个自变量之间相互关系的统计分析方法。  
&emsp; 回归分析研究的主要内容有：确定变量之间的相互关系和相关程度，建立回归模型，检验变量之间的相关程度或回归模型的显著性，应用回归模型进行估计和预测等。  
2. 分类：  
    * 自变量的个数：一元回归与多元回归。  
    * 回归函数的形式：线性回归与非线性回归。  

## 1.2. 线性回归流程  
1. 散点图和相关分析。  
&emsp; 一般来说，回归分析之前需要做相关分析，原因在于相关分析可以先了解是否有关系，回归分析是研究有没有影响关系，有相关关系但并不一定有回归影响关系。  
&emsp; 回归分析之前也可以使用散点图查看数据关系。~~散点图可以粗略地看出x与y相关的形式。~~  
2. 建立模型。  
3. 参数估计。  
4. ~~校验。~~
5. 应用：预测。  


## 1.3. 一元线性回归分析  

### 1.3.1. `建立模型`    
#### 1.3.1.1. 回归模型的建立
&emsp; 一元线性回归模型的数学表达式为：Y = β0 + β1*X + ε。其中，`Y表示因变量，X表示自变量，β0表示截距，β1表示斜率，ε是随机误差项（是服从N（0，a²）分布的随机变量）。`  
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-81.png" style="zoom:30%">      
<img src="http://182.92.69.8:8081/img/stats/stats-144.png" style="zoom:100%">      

#### 1.3.1.2. 回归模型的基本特征  
<img src="http://182.92.69.8:8081/img/stats/stats-79.png" style="zoom:100%">      


### 1.3.2. `参数估计，β0和β1的估计`，最小二乘估计 

#### 1.3.2.1. 最小二乘估计的基本思想  
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-82.png" style="zoom:30%">      

&emsp; 最小二乘估计的基本思想是，寻找一组参数，使得回归方程的`观察值和估计值`之间的误差最小化。具体而言，对于给定的一组自变量和因变量观测值，通过`计算【最小化残差平方和】`来`求解回归系数`的最优估计。  
&emsp; 注意：`最小二乘估计建立在一些假设上`，如误差项服从独立同分布的正态分布、无多重共线性等。同时，最小二乘估计也对异常值和离群值比较敏感，`因此在应用中需要进行残差分析和模型检验`，以评估模型的可靠性和适用性。

#### 1.3.2.2. ★★★步骤  
<!-- 

https://www.bilibili.com/video/BV1ef4y1Z746/?spm_id_from=333.337.search-card.all.click&vd_source=9a9cf49f6bf9bd6a6e6e556f641ae9cb
https://www.bilibili.com/video/BV13P411b7Dr/?spm_id_from=333.337.search-card.all.click&vd_source=9a9cf49f6bf9bd6a6e6e556f641ae9cb

https://www.doc88.com/p-990232006554.html  
https://www.docin.com/p-1548918243.html
https://www.bilibili.com/video/BV14G4y1s7x5/?spm_id_from=333.788.recommend_more_video.-1&vd_source=9a9cf49f6bf9bd6a6e6e556f641ae9cb  

-->

1. 简单线性回归中，最小二乘估计的步骤如下：  
    &emsp; `计算残差（预测值与观测值） ---> 计算残差平方和 ---> 计算回归系数a、b。`  
    1. 建立线性回归模型：Y = β0 + β1X + ε，其中`Y是因变量，X是自变量，β0和β1是回归系数，ε是误差项（ε是服从N（0，a²）分布的随机变量，随机误差项）`。  
    2. `【计算残差】`：对每个观测值，计算`【预测值与观测值】之间的差异`，即残差（e = Y - Ŷ）。  
    3. `【计算残差平方和】`：将每个观测值的残差平方求和，得到残差平方和（SSE）。  
    4. `【计算回归系数a、b】`：求解使得残差平方和最小化的回归系数的值，通过对`回归系数进行求导`并令导数等于零来计算。  
    5. 参数估计：根据最小二乘估计求解出的回归系数，得到回归方程的最佳拟合直线。  

    <!-- 
        &emsp; <img src="http://182.92.69.8:8081/img/stats/stats-99.png" style="zoom:100%">      
    -->

2. `★★★为了便于计算，常用下列记号和等式的各种变形`：   
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-83.png" style="zoom:30%">      


### 1.3.3. ★★★`参数估计，a²的估计`，可决系数r^2与相关系数r  
#### 1.3.3.1. 计算  
&emsp; 计算：`残差平方和、回归平方和、总平方和`  

        总平方和 =  观察值和【平均值】  
        回归平方和 = 预测值和【平均值】  
        残差平方和 = 观察值和预测值  

&emsp; `1.【[SST总偏差平方和（观察值和平均值）]= SSE总误差平方和（观察值和预测值）+ [SSR总回归平方和（预测值和平均值）]】 --->`   
&emsp; `2.【平均误差平方和、平均回归平方和】 ---> 3.【可决系数=SSR(总回归平方和)（预测值和平均值）/SST（总平方和）（观察值和平均值）、相关系数】`   
&emsp; <font color = 'blue'>从最后公式SSR/SST（回归偏差占总偏差比率），也能倒推出SSR是预测值和平均值的差，而SST是观察值和平均值的差。</font>  

&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-145.png" style="zoom:50%">      
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-147.png" style="zoom:100%">      
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-146.png" style="zoom:80%">      

----
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-80.png" style="zoom:80%">      

-------

&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-120.png" style="zoom:100%">      
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-121.png" style="zoom:100%">      

--------
&emsp; （2004年真题）：  
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-203.png" style="zoom:100%">      
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-204.png" style="zoom:100%">      



#### 1.3.3.2. 说明  
&emsp; 说明一元线性回归分析中可决系数r²的取值范围并说明r²=1的含义？（03年考题）    
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-142.png" style="zoom:100%">     

-----------

&emsp; 可决系数是用来衡量回归方程的拟合优度的一种统计指标。可决系数的取值范围通常在0和1之间，表示`【回归方程所能解释的偏差】占【总偏差】的比例`。可决系数越接近1，说明回归方程拟合越好，能够解释的方差越多；可决系数越接近0，说明回归方程拟合效果较差，不能很好地解释观测数据的变异性。可决系数的计算公式如下：  
&emsp; 可决系数（R^2）= 1 - (残差平方和 / 总平方和)  
&emsp; 其中，残差平方和表示回归方程拟合后残差的平方和，总平方和表示因变量观测值与其均值之差的平方和。  

-----------

&emsp; 相关系数r显示了一个线性关系的强度和方向（正或负）。`当两个变量之间存在正向相关时，r为正。当变量之间的关系为负相关时，r也为负数`。`如果数据点正好描述了一条直线，r等于1或-1。当完全没有相关关系时，r将等于零`。`如果某组数据点的相关系数相当低（0.5>r>-0.5），那么线性回归可能不会带来非常可信的结果`。`只有当r高于0.5或低于-0.5时才值得做线性回归`。  

-----------

&emsp; （06年考题）  
&emsp; 可决系数r²是检验回归模型拟合优度的量，它是用总偏差平方在总回归平方和所占的比重来表示的，反映了由于使用回归方程预测y而使总偏差平方和减少的程度。O≤r²≤1，r²越大说明方程拟合程度越高。  

---------------
&emsp; 可决系数r²是检验回归模型拟合优度的量，可决系数是用来衡量回归方程的拟合优度的一种统计指标。  
&emsp; 表示`【回归方程所能解释的方差】占【总方差】的比例`。表示为回归平方和与总离差平方和之比，数值上等于相关系数的平方。    

-----------

&emsp; （2008年真题两个自变量的相关系数接近-1，说明什么?）  
&emsp; <img src="http://182.92.69.8:8081/img/stats/stats-207.png" style="zoom:100%">      



### 1.3.4. ~~校验（不看）~~
#### 1.3.4.1. 回归效果的【显著性检验】与方差分析表  
<img src="http://182.92.69.8:8081/img/stats/stats-101.png" style="zoom:100%">      

##### 1.3.4.1.1. F校验  
<!-- 
https://www.stats.gov.cn/zsk/snapshoot?reference=d466cfa12a8d807d0c267a76a75d1e42_1F23DAC19622C2E93D01BD101DE85ABF&siteCode=tjzsk
https://zhuanlan.zhihu.com/p/644810618?utm_id=0
-->
<img src="http://182.92.69.8:8081/img/stats/stats-102.png" style="zoom:100%">      

-------------

<img src="http://182.92.69.8:8081/img/stats/stats-154.png" style="zoom:100%">      

-------------

<img src="http://182.92.69.8:8081/img/stats/stats-107.png" style="zoom:100%">      


##### 1.3.4.1.2. t校验  
<img src="http://182.92.69.8:8081/img/stats/stats-103.png" style="zoom:100%">      

----------

<img src="http://182.92.69.8:8081/img/stats/stats-155.png" style="zoom:100%">      


#### 1.3.4.2. 回归参数的【假设检验】与区间估计   
<img src="http://182.92.69.8:8081/img/stats/stats-85.png" style="zoom:80%">      

-----

<img src="http://182.92.69.8:8081/img/stats/stats-156.png" style="zoom:100%">      


### 1.3.5. ~~应用：预测（不看）~~  
<img src="http://182.92.69.8:8081/img/stats/stats-86.png" style="zoom:30%">      


## 1.4. 多元线性回归分析
&emsp; [5.2.多元线性回归](/docs/comprehensiveManageDepart/appliedStatistics/linearRegressionTwo.md)   


## 1.5. 线性模型的适宜性评价  
&emsp; 利用观测数据，考查有关线性模型的一些基本假设是否适宜。  
&emsp; 非线性、异方差性、序列相关性、非正态性、多重共线性...  

1. 非线性  
&emsp; 引起的问题：  
&emsp; 判断的方法：  

2. 异方差性  

3. 序列相关性  

4. 非正态性  

5. 多重共线性      
